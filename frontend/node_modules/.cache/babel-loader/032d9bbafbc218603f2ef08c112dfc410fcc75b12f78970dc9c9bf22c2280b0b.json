{"ast":null,"code":"var _jsxFileName = \"/Users/tannywarachai/Documents/CSX4107/UserManagement/frontend/src/components/Profile.js\",\n  _s = $RefreshSig$();\nimport { useUser } from \"../contexts/UserProvider\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Profile() {\n  _s();\n  const {\n    logout\n  } = useUser();\n  const [isLoading, setIsLoading] = useState(true);\n  const [data, setData] = useState({});\n  const [hasImage, setHasImage] = useState(false);\n  const fileInputRef = useRef(null);\n  const navigate = useNavigate();\n  const API_URL = process.env.REACT_APP_API_URL;\n  async function onUpdateImage() {\n    var _fileInputRef$current;\n    const file = (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.files[0];\n    if (!file) {\n      alert(\"Please select a file.\");\n      return;\n    }\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    try {\n      const response = await fetch(`${API_URL}/api/user/profile/image`, {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\"\n      });\n      if (response.ok) {\n        alert(\"Image updated successfully.\");\n        fetchProfile();\n      } else {\n        alert(\"Failed to update image.\");\n      }\n    } catch (err) {\n      alert(\"Error uploading image.\");\n    }\n  }\n  async function fetchProfile() {\n    const result = await fetch(`${API_URL}/api/user/profile`, {\n      credentials: \"include\"\n    });\n    if (result.status === 401) {\n      logout();\n    } else {\n      const data = await result.json();\n      if (data.profileImage != null) {\n        setHasImage(true);\n      }\n      setIsLoading(false);\n      setData(data);\n    }\n  }\n  useEffect(() => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    fetchProfile();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Profile\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"ID: \", data._id, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 26\n      }, this), \"Email: \", data.email, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 31\n      }, this), \"First Name: \", data.firstname, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 40\n      }, this), \"Last Name: \", data.lastname, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 38\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), \"Image:\", \" \", hasImage && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: `${API_URL}${data.profileImage}`,\n        width: 150,\n        height: 150,\n        alt: \"profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        ref: fileInputRef,\n        accept: \"image/*\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onUpdateImage,\n        children: \"Update Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate(\"/logout\"),\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n}\n_s(Profile, \"f8aPDEDNe8HtxM2WoAOOM6nc/t4=\", false, function () {\n  return [useUser, useNavigate];\n});\n_c = Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["useUser","useEffect","useState","useRef","useNavigate","jsxDEV","_jsxDEV","Profile","_s","logout","isLoading","setIsLoading","data","setData","hasImage","setHasImage","fileInputRef","navigate","API_URL","process","env","REACT_APP_API_URL","onUpdateImage","_fileInputRef$current","file","current","files","alert","formData","FormData","append","response","fetch","method","body","credentials","ok","fetchProfile","err","result","status","json","profileImage","children","fileName","_jsxFileName","lineNumber","columnNumber","_id","email","firstname","lastname","src","width","height","alt","type","ref","accept","onClick","_c","$RefreshReg$"],"sources":["/Users/tannywarachai/Documents/CSX4107/UserManagement/frontend/src/components/Profile.js"],"sourcesContent":["import { useUser } from \"../contexts/UserProvider\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function Profile() {\n  const { logout } = useUser();\n  const [isLoading, setIsLoading] = useState(true);\n  const [data, setData] = useState({});\n  const [hasImage, setHasImage] = useState(false);\n  const fileInputRef = useRef(null);\n  const navigate = useNavigate();\n  const API_URL = process.env.REACT_APP_API_URL;\n\n  async function onUpdateImage() {\n    const file = fileInputRef.current?.files[0];\n    if (!file) {\n      alert(\"Please select a file.\");\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"file\", file);\n\n    try {\n      const response = await fetch(`${API_URL}/api/user/profile/image`, {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n\n      if (response.ok) {\n        alert(\"Image updated successfully.\");\n        fetchProfile();\n      } else {\n        alert(\"Failed to update image.\");\n      }\n    } catch (err) {\n      alert(\"Error uploading image.\");\n    }\n  }\n\n  async function fetchProfile() {\n    const result = await fetch(`${API_URL}/api/user/profile`, {\n      credentials: \"include\",\n    });\n\n    if (result.status === 401) {\n      logout();\n    } else {\n      const data = await result.json();\n      if (data.profileImage != null) {\n        setHasImage(true);\n      }\n      setIsLoading(false);\n      setData(data);\n    }\n  }\n\n  useEffect(() => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    fetchProfile();\n  }, []);\n\n  return (\n    <div>\n      <h3>Profile</h3>\n      {isLoading ? (\n        <div>Loading...</div>\n      ) : (\n        <div>\n          ID: {data._id} <br />\n          Email: {data.email} <br />\n          First Name: {data.firstname} <br />\n          Last Name: {data.lastname} <br />\n          <br />\n          Image:{\" \"}\n          {hasImage && (\n            <img\n              src={`${API_URL}${data.profileImage}`}\n              width={150}\n              height={150}\n              alt=\"profile\"\n            />\n          )}\n          <br />\n          <input type=\"file\" ref={fileInputRef} accept=\"image/*\" />\n          <button onClick={onUpdateImage}>Update Image</button>\n        </div>\n      )}\n      <br />\n      <button onClick={() => navigate(\"/logout\")}>Logout</button>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}