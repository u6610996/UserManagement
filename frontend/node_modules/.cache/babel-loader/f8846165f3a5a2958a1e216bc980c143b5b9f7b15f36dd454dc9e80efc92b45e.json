{"ast":null,"code":"var _jsxFileName = \"/Users/tannywarachai/Documents/CSX4107/UserManagement/frontend/src/contexts/UserProvider.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useContext, useState } from \"react\";\nimport { UserContext } from \"./UserContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function UserProvider({\n  children\n}) {\n  _s();\n  var _JSON$parse;\n  const initialUser = (_JSON$parse = JSON.parse(localStorage.getItem(\"session\"))) !== null && _JSON$parse !== void 0 ? _JSON$parse : {\n    isLoggedIn: false,\n    name: \"\",\n    email: \"\"\n  };\n  const API_URL = process.env.REACT_APP_API_URL;\n  const [user, setUser] = useState(initialUser);\n  const login = async (email, password) => {\n    try {\n      const result = await fetch(`${API_URL}/api/user/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          email,\n          password\n        }),\n        credentials: \"include\"\n      });\n      if (result.status !== 200) {\n        return false;\n      } else {\n        const newUser = {\n          isLoggedIn: true,\n          name: \"\",\n          email: email\n        };\n        setUser(newUser);\n        localStorage.setItem(\"session\", JSON.stringify(newUser));\n        return true;\n      }\n    } catch (error) {\n      console.log(\"Login Exception: \", error);\n      return false;\n    }\n  };\n  const logout = async () => {\n    await fetch(`${API_URL}/api/user/logout`, {\n      method: \"POST\",\n      credentials: \"include\"\n    });\n    const newUser = {\n      isLoggedIn: false,\n      name: \"\",\n      email: \"\"\n    };\n    setUser(newUser);\n    localStorage.setItem(\"session\", JSON.stringify(newUser));\n  };\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      login,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n}\n_s(UserProvider, \"VrCugiy0UFkwlBI+AwXYBW5CQ4Y=\");\n_c = UserProvider;\nexport function useUser() {\n  _s2();\n  return useContext(UserContext);\n}\n_s2(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["useContext","useState","UserContext","jsxDEV","_jsxDEV","UserProvider","children","_s","_JSON$parse","initialUser","JSON","parse","localStorage","getItem","isLoggedIn","name","email","API_URL","process","env","REACT_APP_API_URL","user","setUser","login","password","result","fetch","method","headers","body","stringify","credentials","status","newUser","setItem","error","console","log","logout","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useUser","_s2","$RefreshReg$"],"sources":["/Users/tannywarachai/Documents/CSX4107/UserManagement/frontend/src/contexts/UserProvider.js"],"sourcesContent":["import { useContext, useState } from \"react\";\nimport { UserContext } from \"./UserContext\";\n\nexport function UserProvider({ children }) {\n  const initialUser = JSON.parse(localStorage.getItem(\"session\")) ?? {\n    isLoggedIn: false,\n    name: \"\",\n    email: \"\",\n  };\n\n  const API_URL = process.env.REACT_APP_API_URL;\n  const [user, setUser] = useState(initialUser);\n\n  const login = async (email, password) => {\n    try {\n      const result = await fetch(`${API_URL}/api/user/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ email, password }),\n        credentials: \"include\",\n      });\n\n      if (result.status !== 200) {\n        return false;\n      } else {\n        const newUser = { isLoggedIn: true, name: \"\", email: email };\n        setUser(newUser);\n        localStorage.setItem(\"session\", JSON.stringify(newUser));\n        return true;\n      }\n    } catch (error) {\n      console.log(\"Login Exception: \", error);\n      return false;\n    }\n  };\n\n  const logout = async () => {\n    await fetch(`${API_URL}/api/user/logout`, {\n      method: \"POST\",\n      credentials: \"include\",\n    });\n    const newUser = { isLoggedIn: false, name: \"\", email: \"\" };\n    setUser(newUser);\n    localStorage.setItem(\"session\", JSON.stringify(newUser));\n  };\n\n  return (\n    <UserContext.Provider value={{ user, login, logout }}>\n      {children}\n    </UserContext.Provider>\n  );\n}\n\nexport function useUser() {\n  return useContext(UserContext);\n}\n"],"mappings":";;;AAAA,SAASA,UAAU,EAAEC,QAAQ,QAAQ,OAAO;AAC5C,SAASC,WAAW,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE5C,OAAO,SAASC,YAAYA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EAAA,IAAAC,WAAA;EACzC,MAAMC,WAAW,IAAAD,WAAA,GAAGE,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,cAAAL,WAAA,cAAAA,WAAA,GAAI;IACjEM,UAAU,EAAE,KAAK;IACjBC,IAAI,EAAE,EAAE;IACRC,KAAK,EAAE;EACT,CAAC;EAED,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB;EAC7C,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGrB,QAAQ,CAACQ,WAAW,CAAC;EAE7C,MAAMc,KAAK,GAAG,MAAAA,CAAOP,KAAK,EAAEQ,QAAQ,KAAK;IACvC,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMC,KAAK,CAAC,GAAGT,OAAO,iBAAiB,EAAE;QACtDU,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEnB,IAAI,CAACoB,SAAS,CAAC;UAAEd,KAAK;UAAEQ;QAAS,CAAC,CAAC;QACzCO,WAAW,EAAE;MACf,CAAC,CAAC;MAEF,IAAIN,MAAM,CAACO,MAAM,KAAK,GAAG,EAAE;QACzB,OAAO,KAAK;MACd,CAAC,MAAM;QACL,MAAMC,OAAO,GAAG;UAAEnB,UAAU,EAAE,IAAI;UAAEC,IAAI,EAAE,EAAE;UAAEC,KAAK,EAAEA;QAAM,CAAC;QAC5DM,OAAO,CAACW,OAAO,CAAC;QAChBrB,YAAY,CAACsB,OAAO,CAAC,SAAS,EAAExB,IAAI,CAACoB,SAAS,CAACG,OAAO,CAAC,CAAC;QACxD,OAAO,IAAI;MACb;IACF,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEF,KAAK,CAAC;MACvC,OAAO,KAAK;IACd;EACF,CAAC;EAED,MAAMG,MAAM,GAAG,MAAAA,CAAA,KAAY;IACzB,MAAMZ,KAAK,CAAC,GAAGT,OAAO,kBAAkB,EAAE;MACxCU,MAAM,EAAE,MAAM;MACdI,WAAW,EAAE;IACf,CAAC,CAAC;IACF,MAAME,OAAO,GAAG;MAAEnB,UAAU,EAAE,KAAK;MAAEC,IAAI,EAAE,EAAE;MAAEC,KAAK,EAAE;IAAG,CAAC;IAC1DM,OAAO,CAACW,OAAO,CAAC;IAChBrB,YAAY,CAACsB,OAAO,CAAC,SAAS,EAAExB,IAAI,CAACoB,SAAS,CAACG,OAAO,CAAC,CAAC;EAC1D,CAAC;EAED,oBACE7B,OAAA,CAACF,WAAW,CAACqC,QAAQ;IAACC,KAAK,EAAE;MAAEnB,IAAI;MAAEE,KAAK;MAAEe;IAAO,CAAE;IAAAhC,QAAA,EAClDA;EAAQ;IAAAmC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B;AAACrC,EAAA,CAlDeF,YAAY;AAAAwC,EAAA,GAAZxC,YAAY;AAoD5B,OAAO,SAASyC,OAAOA,CAAA,EAAG;EAAAC,GAAA;EACxB,OAAO/C,UAAU,CAACE,WAAW,CAAC;AAChC;AAAC6C,GAAA,CAFeD,OAAO;AAAA,IAAAD,EAAA;AAAAG,YAAA,CAAAH,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}